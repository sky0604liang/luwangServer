(function(h,e){var g=0,j=0,c={},a={spread:"spread",shrink:"shrink"};function b(m,k){if(!m||!m.nodeName||(m.nodeType!=1)){throw"YnTree 第一个参数必须是一个元素！";}this.ele=m;
var l=b.getType(k);if(l!="object"){throw"YnTree 第二个参数必须是一个对象！";}this.options=k;!this.options.data?this.options.data=[]:"";if(b.getType(this.options.data)=="object"){this.options.data=[this.options.data];
}this.data=[];this.parallel=[];this.id="yn_tree"+(++g);this.tree=b.createDomByString('<ul class="yn-tree" id="'+this.id+'"></ul>');this._init();}b.prototype._init=function(){var k=this;
if(this.options.data.length>0){this._copyData(this.options.data,this.data);this._createDom(this.data);this._assemblyDom(this.tree,this.data);}this.ele.appendChild(this.tree);
console.log(this);c[this.id]=this;return this;};b.prototype.version="1.0.0";b.prototype._copyData=function(m,k){var l=this;m=m||l.options.data;b.getType(m)!="array"?(m=[m]):"";
b.forEach(m,function(n,o){if(o.children){var p=new f(o,"composite",l.id);k.push(p);l.parallel.push(p);l._copyData(o.children,p.children);}else{var p=new f(o,"leaf",l.id);
k.push(p);l.parallel.push(p);}});return this;};b.prototype._createDom=function(m,k){var l=this;b.forEach(m,function(r,v){var q="",n="yn_tree_input"+(++j),t=v.inputName?v.inputName:"",o=v.value?v.value:"",u=v.checked?v.checked:false,p=v.disabled?v.disabled:false,s=v.className?v.className:"";
q+='<li class="yn-tree-li shrink" id="'+n+'_li" '+(k?('pid="'+k.id+'"'):"")+">";q+='	<div class="checkbox">';if(v.children){q+='<span class="arrow arrow-right"></span>';
}q+="		<label>";q+='			<input type="checkbox" class="yn-tree-input '+s+'" id="'+n+'" '+(u?'checked="checked"':"")+(p?'disabled="disabled"':"")+(k&&k.id?(' pid="'+k.id+'"'):"")+' name="'+t+'" value="'+o+'">'+v.name;
q+="		</label>";q+="	</div>";if(v.children){q+='<ul class="yn-tree"></ul>';v.type="composite";}else{v.type="leaf";}q+="</li>";v.id=n;v.pid=(k?k.id:null);
v.dom=b.createDomByString(q);d(v.dom.querySelector(".yn-tree-input"),v);if(v.children){i(v.dom.querySelector(".arrow-right"),v);}if(v.children){l._createDom(v.children,v);
}});return this;};b.prototype._assemblyDom=function(k,m){var l=this;if(!k&&!m){return this;}b.getType(m)!="array"?(m=[m]):m;b.forEach(m,function(n,o){k.appendChild(o.dom);
if(o.children){l._assemblyDom(o.dom.querySelector(".yn-tree"),o.children);}});return this;};b.prototype.select=function(n,k){var m=this,l=null;b.forEach(m.parallel,function(p,q){var o=document.getElementById(q.id);
if(n===q.id||n===q.value||n===o){l=q;return false;}});l.select(k);return this;};b.prototype.disable=function(n,k){var m=this,l=null;b.forEach(m.parallel,function(p,q){var o=document.getElementById(q.id);
if(n===q.id||n===q.value||n===o){l=q;return false;}});l.disable(k);return this;};b.prototype.getCheckedInputs=function(){var l=this,k=[];b.forEach(l.parallel,function(m,n){if(n.checked){k.push(document.getElementById(n.id));
}});return k;};b.prototype.getValues=function(){var l=this,k=[];b.forEach(l.getCheckedInputs(),function(m,n){k.push(n.value);});return k;};b.prototype.reInit=function(l){var k=this;
if(l&&b.getType(l)=="array"){this.options.data=l;}if(this.options.data.length>0){this.ele.removeChild(this.tree);this.tree=b.createDomByString('<ul class="yn-tree" id="'+this.id+'"></ul>');
this.data=[];this._copyData(this.options.data,this.data);this._createDom(this.data);this._assemblyDom(this.tree,this.data);this.ele.appendChild(this.tree);
}console.log("重新初始化");return this;};b.prototype.destroy=function(){this.ele.removeChild(this.tree);this.options=null;this.parallel=null;this.tree=null;
this.id=null;this.data=null;this.ele=null;console.info("YnTree销毁完毕，建议您将YnTree的实例置为null，如：\r\n var ynTree = new YnTree(...);\r\n ynTree.destroy();\r\n ynTree = null;");
};b.prototype.spread=function(n,k){var m=this,l=null;b.forEach(m.parallel,function(p,q){var o=document.getElementById(q.id);if(n===q.id||n===q.value||n===o){l=q;
return false;}});if(l.type=="leaf"){return this;}l.spread(k);return this;};b.createDomByString=function(m){var k=document.createElement("div"),l;k.innerHTML=m;
l=k.children;k=null;return l[0];};b.getType=function(l){var k=Object.prototype.toString.call(l);return k.replace("[","").replace("]","").split(" ")[1].toLowerCase();
};b.forEach=function(l,n){if(b.getType(l)!="array"){return l;}for(var m=0,k=l.length;m<k;m++){var o=n.call(l[m],m,l[m]);if(o===false){break;}}return l;
};b.on=function(n,m,l){if(document.addEventListener){n.addEventListener(m,l,false);}else{if(h.attachEvent){if(!n["_"+m+"_event"]){var k=[l];n["_"+m+"_event"]=k;
}else{n["_"+m+"_event"].push(l);}n.attachEvent("on"+m,function(){var o=h.event;o.preventDefault=function(){o.returnValue=false;};o.stopPropagation=function(){o.calcleBubble=true;
};o.target=o.srcElement;l.call(n,o);});}}return n;};b.extend=function(m,l){for(var k in l){if(l.hasOwnProperty(k)){m[k]=l[k];}}return m;};function d(k,l){b.on(k,"change",function(n){var m=n.target;
l.select(m.checked);});}function i(k,l){b.on(k,"click",function(m){l.spread();});}function f(k,l,m){this.type=l||"";b.extend(this,k||{});if(this.children){this.children=[];
}this.ynTreeId=m;}f.prototype={constructor:f,selectDown:function(k){var l=this;k=!!k;if(l.children){b.forEach(l.children,function(m,n){if(!n.disabled){n.checked=k;
n.dom.querySelector(".yn-tree-input").checked=k;}if(n.children){b.forEach(n.children,arguments.callee);}});}return this;},selectUp:function(k){var m=this,l=null;
k=!!k;if(!this.pid){return this;}b.forEach(m.getYnTree(m.ynTreeId).parallel,function(o,p){if(p.id===m.pid){l=p;return false;}});if(k){l.checked=k;document.getElementById(l.id).checked=k;
}else{var n=true;b.forEach(l.children,function(o,p){if(p.checked){n=false;return false;}});if(n){l.checked=k;document.getElementById(l.id).checked=k;}}if(l.pid){l.selectUp(k);
}return this;},select:function(k){var m=this,l=document.getElementById(m.id),n=this.getYnTree(this.ynTreeId);k=!!k;if(!m.disabled){m.checked=k;l.checked=k;
}n.options.onchange&&(b.getType(n.options.onchange)=="function")&&n.options.onchange.call(this,l,n);if(typeof n.options.checkStrictly=="undefined"||n.options.checkStrictly===true){if(m.type=="composite"){this.selectDown(k);
}if(m.pid){this.selectUp(k);}}return this;},disable:function(k){var m=this,l=document.getElementById(m.id),n=this.getYnTree(this.ynTreeId);k=!!k;m.disabled=k;
l.disabled=k;return this;},getYnTree:function(l){var k;if(l in c){k=c[l];}return k;},spread:function(q){var o=this,p=document.getElementById(o.id+"_li"),s=this.getYnTree(this.ynTreeId),u=p.className.split(" "),m=false,k=-1,r=false,t=-1;
if(o.type=="leaf"){return this;}for(var l=0,n=u.length;l<n;l++){if(u[l]===a.spread){m=true;k=l;}if(u[l]===a.shrink){r=true;t=l;}}if(typeof q=="undefined"){if(m){q=false;
}else{if(r){q=true;}}}q=!!q;if(q){if(m){return this;}if(r){u.splice(t,1);}u.push(a.spread);p.className=u.join(" ");}else{if(r){return this;}if(m){u.splice(k,1);
}u.push(a.shrink);p.className=u.join(" ");}return this;}};h.YnTree=b;})(window,undefined);